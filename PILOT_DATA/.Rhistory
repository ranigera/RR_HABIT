geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), color="black") +
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 1, label = '95% power') +
annotate('text', y = 83, x = 1, label = '80% power') +
theme_bw() +
xlim(-5, 550)
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), color="black") +
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 1, label = '95% power') +
annotate('text', y = 83, x = 1, label = '80% power') +
theme_bw() +
xlim(-5, 545)
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=0.2,color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 1, label = '95% power') +
annotate('text', y = 83, x = 1, label = '80% power') +
theme_bw()
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=0.2, size = 1, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4)
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), size = 1, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4)
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width = 1, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4)
m_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width = 0.9, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4)
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width = 0.9, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 1, label = '95% power') +
annotate('text', y = 83, x = 1, label = '80% power') +
theme_bw()
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.2, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 1, label = '95% power') +
annotate('text', y = 83, x = 1, label = '80% power') +
theme_bw()
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4)
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 1, label = '95% power') +
annotate('text', y = 83, x = 1, label = '80% power') +
theme_bw()
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, aes( ymin = CIlow , ymax = CIup), color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4)
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, aes( ymin = CIlow , ymax = CIup), width=.1, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 1, label = '95% power') +
annotate('text', y = 83, x = 1, label = '80% power') +
theme_bw()
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
#geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 1, label = '95% power') +
annotate('text', y = 83, x = 1, label = '80% power') +
theme_bw()
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
#geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black") + # add reduce witdh
annotate('text', y = 97, x = 1, label = '95% power') +
annotate('text', y = 83, x = 1, label = '80% power') +
theme_bw()
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
#geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
geom_errorbar(data = db, aes( ymin = CIlow , ymax = CIup), color="black")
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
#geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
geom_errorbar(data = db, aes( ymin = CIlow , ymax = CIup), width=.3)
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
#geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
geom_errorbar(aes( ymin = CIlow , ymax = CIup), width=.3)
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
#geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
geom_errorbar(aes( ymin = CIlow , ymax = CIup), width=.3,size=1, position=pd)
#geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black") + # add reduce witdh
pd <- position_dodge(0.3)
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
#geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
geom_errorbar(aes( ymin = CIlow , ymax = CIup), width=.3,size=1, position=pd)
ggplot(db, aes(x = ID, y = means)) +
#geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
#geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4)
gplot(db, aes(x = ID, y = means)) +
#geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
#geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black") + # add reduce witdh
gplot(db, aes(x = ID, y = means)) +
#geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
#geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black") + # add reduce witdh
)
ggplot(db, aes(x = ID, y = means)) +
#geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
#geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black") + # add reduce witdh
)
ggplot(db, aes(x = ID, y = means)) +
#geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
#geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width=.9, color="black")
ggplot(db, aes(x = ID, y = means)) +
#geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
#geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), color="black")
ggplot(db, aes(x = ID, y = means)) +
#geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
#geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
#geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), color="black")
ggplot(db, aes(x = ID, y = means)) +
#geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
#geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
#geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width= .3, color="black")
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width= .3, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 1, label = '95% power') +
annotate('text', y = 83, x = 1, label = '80% power') +
theme_bw() +
labs(
title = '',
x = "Number of participants",
y = "Estimated power (%)"
)
pp <- ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width= .3, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 1, label = '95% power') +
annotate('text', y = 83, x = 1, label = '80% power') +
theme_bw() +
labs(
title = '',
x = "Number of participants",
y = "Estimated power (%)"
)
pp + theme_linedraw(base_size = 12, base_family = "Helvetica")+
theme(strip.text.x = element_text(size = 10, face = "bold"),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
axis.line.y = element_line(size = 0.5, linetype = "solid", colour = "#999999"),
axis.line.x = element_line(size = 0.5, linetype = "solid", colour = "#999999"),
legend.justification = c(1,1), legend.position = "right",
legend.text  = element_text(size = 12),
#axis.ticks.x = element_blank(),
axis.title.y = element_text(size = 12))
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 1, label = '95% power') +
annotate('text', y = 83, x = 1, label = '80% power') +
theme_bw() +
labs(
title = '',
x = "Number of participants",
y = "Estimated power (%)"
)
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width= .3, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 5, label = '95% power') +
annotate('text', y = 83, x = 5, label = '80% power') +
theme_bw()
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width= .3, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = -1, label = '95% power') +
annotate('text', y = 83, x = 5, label = '80% power') +
theme_bw()
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width= .3, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = -1, label = '95% power')
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width= .3, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 100, label = '95% power') +
annotate('text', y = 83, x = 5, label = '80% power')
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width= .3, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 100, label = '95% power') +
annotate('text', y = 83, x = 100, label = '80% power') +
geom_vline(xintercept = 400)
ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width= .3, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 80, label = '95% power') +
annotate('text', y = 83, x = 80, label = '80% power') +
geom_vline(xintercept = 400, color= "gray")
theme_bw()
pp <- ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width= .3, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 80, label = '95% power') +
annotate('text', y = 83, x = 80, label = '80% power') +
geom_vline(xintercept = 400, color= "gray")
pp + theme_linedraw(base_size = 12, base_family = "Helvetica")+
theme(strip.text.x = element_text(size = 10, face = "bold"),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
axis.line.y = element_line(size = 0.5, linetype = "solid", colour = "#999999"),
axis.line.x = element_line(size = 0.5, linetype = "solid", colour = "#999999"),
legend.justification = c(1,1), legend.position = "right",
legend.text  = element_text(size = 12),
axis.title.y = element_text(size = 12))
pp <- ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width= .3, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 80, label = '95% power') +
annotate('text', y = 83, x = 80, label = '80% power') +
geom_vline(xintercept = 400, color= "gray")
theme_bw() +
labs(
title = '',
x = "Number of participants",
y = "Estimated power (%)"
)
p
pp <- ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width= .3, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 80, label = '95% power') +
annotate('text', y = 83, x = 80, label = '80% power') +
geom_vline(xintercept = 400, color= "gray")
pp + theme_linedraw(base_size = 12, base_family = "Helvetica")+
theme(strip.text.x = element_text(size = 10, face = "bold"),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
axis.line.y = element_line(size = 0.5, linetype = "solid", colour = "#999999"),
axis.line.x = element_line(size = 0.5, linetype = "solid", colour = "#999999"),
legend.justification = c(1,1), legend.position = "right",
legend.text  = element_text(size = 12),
axis.title.y = element_text(size = 12))
pp <- ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width= .3, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 80, label = '95% power') +
annotate('text', y = 83, x = 80, label = '80% power') +
geom_vline(xintercept = 400, color= "gray") +
theme_bw() +
labs(
title = '',
x = "Number of participants",
y = "Estimated power (%)"
)
ppp <- pp + theme_linedraw(base_size = 12, base_family = "Helvetica")+
theme(strip.text.x = element_text(size = 10, face = "bold"),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
axis.line.y = element_line(size = 0.5, linetype = "solid", colour = "#999999"),
axis.line.x = element_line(size = 0.5, linetype = "solid", colour = "#999999"),
legend.justification = c(1,1), legend.position = "right",
legend.text  = element_text(size = 12),
axis.title.y = element_text(size = 12))
pp + theme_linedraw(base_size = 12, base_family = "Helvetica")+
theme(strip.text.x = element_text(size = 10, face = "bold"),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
axis.line.y = element_line(size = 0.5, linetype = "solid", colour = "#999999"),
axis.line.x = element_line(size = 0.5, linetype = "solid", colour = "#999999"),
legend.justification = c(1,1), legend.position = "right",
legend.text  = element_text(size = 12),
axis.title.y = element_text(size = 12))
pdf(file.path(figures_path,'Figure_power.pdf'))
print(ppp)
dev.off()
dev.off
dev.off()
dev.off()
save(powerD, file.path(home_path,'/ANALYSIS/powerAnalysis/powerInteractionCurve.RDATA'))
plot(powerD)
dev.print(pdf, file.path(figures_path,'Figure_powerInteraction.pdf'))
pdf (file.path(figures_path,'Figure_powerInteraction.pdf'))
print(powerplot)
dev.off()
dev.off()
dev.off()
powerplot <- plot(powerD)
dev.print(pdf, file.path(figures_path,'Figure_powerInteraction.pdf'))
pdf (file.path(figures_path,'Figure_powerInteraction.pdf'))
print(powerplot)
dev.off()
pdf (file.path(figures_path,'Figure_powerInteraction.pdf'))
print(powerplot)
dev.off()
dev.off()
sink(file.path(home_path,'ANALYSIS/powerAnalysis/dataForPlotInteraction.txt'))
sink(file.path(home_path,'ANALYSIS/powerAnalysis/dataForPlotInteraction.txt'))
powerD # you will need to manually modify this file
sink()
powerplot <- plot(powerD)
pdf (file.path(figures_path,'Figure_powerInteraction.pdf'))
print(powerplot)
dev.off()
dev.off()
save.Rdata()
install.packages('save.Rdata')
save (powerS, file = file.path(home_path,'ANALYSIS/powerAnalysis/powerInteraction.RDATA'))
save(powerD, file = file.path(home_path,'/ANALYSIS/powerAnalysis/powerInteractionCurve.RDATA'))
powerplot <- plot(powerD)
dev.print(pdf, file.path(figures_path,'Figure_powerInteraction.pdf'))
dev.off()
db_plot <- read.delim(file.path(home_path,'ANALYSIS/powerAnalysis/dataForPlotInteraction.txt'), header = F, sep ='', skip = 2, nrows = 10) # read in dataset
db <- rename(db_plot, c("V1"="ID", "V2"="means", "V3"="CIlow","V4"="CIup"))
pp <- ggplot(db, aes(x = ID, y = means)) +
geom_abline(slope=0, intercept=95, linetype = "dashed", color = "red", size = 1) +
geom_abline(slope=0, intercept=80, linetype = "dashed", color = "gray", size = 0.5) +
geom_line(data= db, stat = "identity",  color="#999999") +
geom_errorbar(data = db, stat = "identity", aes( ymin = CIlow , ymax = CIup), width= .3, color="black") + # add reduce witdh
geom_point(data=db, stat = "identity", size = 4) +
annotate('text', y = 97, x = 80, label = '95% power') +
annotate('text', y = 83, x = 80, label = '80% power') +
geom_vline(xintercept = 400, color= "gray") +
theme_bw() +
labs(
title = '',
x = "Number of participants",
y = "Estimated power (%)"
)
ppp <- pp + theme_linedraw(base_size = 12, base_family = "Helvetica")+
theme(strip.text.x = element_text(size = 10, face = "bold"),
plot.title = element_text(size = 12, face = "bold", hjust = 0.5),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_blank(),
axis.line.y = element_line(size = 0.5, linetype = "solid", colour = "#999999"),
axis.line.x = element_line(size = 0.5, linetype = "solid", colour = "#999999"),
legend.justification = c(1,1), legend.position = "right",
legend.text  = element_text(size = 12),
axis.title.y = element_text(size = 12))
pdf(file.path(figures_path,'Figure_power.pdf'))
print(ppp)
dev.off()
# Anxiety -1 SD
CHANGE.naomit$ANX_pSD <- scale(CHANGE.naomit$ANXIETY, scale = T) + 1 # here I'm going to test at - 1SD (so people that are low in anxiety)
mdl.slp = lmer(normPressFreq~ group*cue*prepost*ANX_pSD + itemxcondition + site + (cue*prepost+itemxcondition|ID), data = CHANGE.naomit, REML=FALSE)
#let's check that the simr we obtain the same main result
doTest(mdl.slp, test=fixed("group:cue:prepost", method = "anova"), lmerTestType = 3)# this does not work it looks like it cannot read more than
#let's calcualte the power we have in our sample
powerA1 <- powerSim(mdl.slp,test=fixed("group:cue:prepost", method = "anova"),lmerTestType=3, nsim =50)
powerA1 # here we notice we only have 62% power, we need to simulate more participants
# let's add simulated participants to our sample to obtain more power
simulated.complex <- extend(mdl.slp, along="ID", n=500) # let simulate double the amount of particpants
powerS1 <- powerSim(simulated.slp,test=fixed("group:cue:prepost", method = "anova"),lmerTestType=3, nsim =50)
powerS1 # Now we have enoungh power
save(powerS1, file = file.path(home_path,'ANALYSIS/powerAnalysis/powerSigleSlope.RDATA'))
#let's now calcuate of how much we can reduce the sample to obtain a 90% power
powerD1 <- powerCurve(simulated.complex,along = 'ID', test=fixed("group:cue:prepost", method = "anova"),lmerTestType=3, nsim =500)
save(powerD1, file = file.path(home_path,'ANALYSIS/powerAnalysis/powerSigleSlopeCurveß.RDATA'))
#----- figure
powerplot <- plot(powerD1)
dev.print(pdf, file.path(figures_path,'Figure_powerSingleSlope.pdf'))
pdf (file.path(figures_path,'Figure_powerSingleSlope.pdf'))
print(powerplot)
dev.off()
ps <- lastResult()
ps$errors
powerD1
powerD1
powerD1
powerD1
plot(powerD1)
plot(powerD1)
powerD1
print.powerSim(powerD1)
print(powerD)
print(powerD1)
sink(file.path(home_path,'ANALYSIS/powerAnalysis/dataForPlotSingleSlope.txt'))
powerD1 # you will need to manually modify this file
sink()
save(powerD1, file = file.path(home_path,'ANALYSIS/powerAnalysis/powerSigleSlopeCurveß.RDATA'))
save(powerS1, file = file.path(home_path,'ANALYSIS/powerAnalysis/powerSigleSlope.RDATA'))
mdl.slp = lmer(normPressFreq~ group*cue*prepost*ANX_pSD + itemxcondition + site + (cue*prepost+itemxcondition|ID), data = CHANGE.naomit, REML=FALSE)
doTest(mdl.slp, test=fixed("group:cue:prepost", method = "anova"), lmerTestType = 3)# this does not work it looks like it cannot read more than
simulated.complex <- extend(mdl.slp, along="ID", n=500) # let simulate double the amount of particpants
powerS1 <- powerSim(simulated.slp,test=fixed("group:cue:prepost", method = "anova"),lmerTestType=3, nsim =50)
powerS1 <- powerSim(simulated.complex,test=fixed("group:cue:prepost", method = "anova"),lmerTestType=3, nsim =50)
save(powerS1, file = file.path(home_path,'ANALYSIS/powerAnalysis/powerSigleSlope.RDATA'))
